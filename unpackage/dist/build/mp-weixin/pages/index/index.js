(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"1d8c":function(t,a,e){"use strict";e.r(a);var i=e("29e5"),s=e("6fd4");for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);e("e17a");var c=e("2877"),o=Object(c["a"])(s["default"],i["a"],i["b"],!1,null,null,null);a["default"]=o.exports},"29e5":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("view",{staticClass:"container"},[t.htmlshow?e("view",{staticClass:"htmlshow"},[t._v("加载中~")]):t._e(),t.htmlshow?t._e():e("view",[e("view",{staticClass:"lucky-wheel"},[e("image",{staticClass:"topBgc",attrs:{mode:"widthFix",src:t.alldata?t.alldata.activityInfo.background_img:""}}),e("button",{staticClass:"mygoods",attrs:{eventid:"7e595675-0"},on:{click:t.gomygoods}},[e("image",{staticClass:"mygoodsbtnimg",attrs:{src:"../../static/img/wdjpbtn.png"}})]),e("button",{staticClass:"paihangb",attrs:{eventid:"7e595675-1"},on:{click:t.goranking}},[e("image",{staticClass:"paihangbbtnimg",attrs:{src:"../../static/img/phbbtn.png"}})]),e("view",{staticClass:"lucky-title"},[e("view",{staticClass:"lotterytime"},[t._v("活动时间:"+t._s(t.globalData?t.globalData.getres.start_time:"0-0-0")+"-"+t._s(t.globalData?t.globalData.getres.end_time:"0-0-0"))])]),e("view",{staticClass:"swiper_"},[e("image",{staticClass:"swiper_bgc",attrs:{src:"../../static/img/swipbgc.png"}}),e("swiper",{staticClass:"swiper_container",attrs:{vertical:"true",autoplay:"true",circular:"true",interval:"2000","v:if":"openRed.length !=0"}},t._l(t.winnerList,function(a,i){return e("swiper-item",{key:i,attrs:{mpcomid:"7e595675-0-"+i}},[e("view",{staticClass:"swiper_item"},[e("text",[t._v("恭喜用户")]),e("text",[t._v(t._s(a.nickname))]),e("text",[t._v("成功抽中")]),e("text",[t._v(t._s(a.prize_name))])])])}))],1),t.activity_endtime?e("view",{attrs:{id:"lottery"}},[e("image",{staticClass:"lotteryBgc",attrs:{src:"../../static/img/cardbgc.png"}}),e("view",{attrs:{id:"guagua"}},[e("canvas",{directives:[{name:"show",rawName:"v-show",value:!t.pristatu&&!t.auther,expression:"!pristatu && !auther"}],attrs:{"canvas-id":"guaguaCanvas","disable-scroll":"true",eventid:"7e595675-2"},on:{touchstart:t.startCanvas,touchmove:t.moveCanvas,touchend:t.endCanvas}}),e("view",{staticClass:"guagua-re"},[t._v(t._s(t.result_val))])])]):t._e(),t.activity_endtime?t._e():e("view",{staticClass:"endtime"},[t._v("活动已结束")]),e("view",{staticClass:"available_num"},[t._v("您今日还有"),e("text",[t._v(t._s(t.available_num))]),t._v("次抽奖机会")])],1),e("view",{staticClass:"exchange"},[e("image",{staticClass:"exchangeBgc",attrs:{src:"../../static/img/exchangeBgc.png"}}),e("view",{staticClass:"exchangeinfo"},[e("view",{staticClass:"exchangeinfoleft"},[e("view",{staticClass:"exchangetop"},[t._v("已获得积分："+t._s(t.alldata?t.alldata.userInfo.income_gold:"0"))]),e("view",{staticClass:"exchangebtm"},[t._v("可兑换积分："+t._s(t.alldata?t.alldata.userInfo.surplus_gold:"0"))])]),e("view",{staticClass:"exchangeinforight"},[e("button",{staticClass:"Btn",attrs:{"data-appid":"wx62442cceb6dba222",eventid:"7e595675-3"},on:{click:t.goexchange}},[t._v("去兑换")])],1)])]),e("view",{staticClass:"Invitationtask"},[e("view",{staticClass:"Invtaskinfo"},[e("image",{staticClass:"InvBgc",attrs:{src:"../../static/img/InvBgc.png",mode:""}}),e("view",{staticClass:"distitle"},[t._v("还差"),e("text",[t._v(t._s(t.round_count))]),t._v("人可抽一次")]),e("view",{staticClass:"fivepeo"},[t._l(5-t.round_count,function(a,i){return e("view",{key:i,staticClass:"btmpeo"},[e("button",{staticClass:"fivebtn"},[e("image",{staticClass:"btnpeoheard",attrs:{src:t.inviteList[t.inviteList.length-1-i]?t.inviteList[t.inviteList.length-1-i].headimg:"../../static/img/deftheard.png",mode:""}})]),e("view",{staticClass:"fivename"},[t._v(t._s(t.inviteList[t.inviteList.length-1-i]?t.inviteList[t.inviteList.length-1-i].nickname:"无名"))])],1)}),t._l(t.round_count,function(a,i){return e("view",{key:i,staticClass:"yaoqing"},[e("button",{staticClass:"fivebtn",attrs:{"open-type":"share","form-type":"submit"}},[e("image",{staticClass:"fivebtnimg",attrs:{src:"../../static/img/addbtn.png",mode:""}})]),e("view",{staticClass:"fivebtname"},[t._v("待邀请")])],1)})],2)])]),e("view",{staticClass:"yaoqinall"},[0!=t.inviteList.length?e("button",{staticClass:"lookall",attrs:{eventid:"7e595675-4"},on:{click:t.lookallfun}},[t._v("查看全部")]):t._e()],1),e("view",{staticClass:"Invitationtask"},[e("view",{staticClass:"openinfo"},[e("image",{staticClass:"openBgc",attrs:{src:"../../static/img/openBgc.png",mode:""}}),e("view",{staticClass:"openlist"},[e("view",{staticClass:"openheard"},[e("img",{staticClass:"heardimg",attrs:{src:t.alldata?t.alldata.activityInfo.jump_img:"../../static/img/deftheard.png",alt:""}})]),e("view",{staticClass:"openbrie"},[e("view",{staticClass:"opentop"},[t._v("每天打开一次小程序")]),e("view",{staticClass:"openbtm"},[t._v("送"),e("text",[t._v(t._s(1))]),t._v("次抽奖机会")])]),e("view",{staticClass:"openBtn"},[e("button",{staticClass:"Btn",attrs:{"data-appid":t.alldata?t.alldata.activityInfo.jump_appid:"",eventid:"7e595675-5"},on:{click:t.openxcx}},[t._v("立即打开")])],1)])])]),e("view",{staticClass:"Invitationtask"},[e("view",{staticClass:"ruleinfo"},[e("image",{staticClass:"ruleBgc",attrs:{src:"../../static/img/ruleBgc.png",mode:""}}),e("scroll-view",{staticClass:"scroll-Y",attrs:{"scroll-top":0,"scroll-y":"true"}},t._l(t.ruleList,function(a,i){return e("view",{key:i,staticClass:"rulelist"},[t._v(t._s(i+1)+"."+t._s(a.describe))])}))],1)]),t.pristatu?e("view",{staticClass:"mask",attrs:{catchtouchmove:"true",eventid:"7e595675-7"},on:{click:t.closeprize}},[e("view",{staticClass:"prizebox"},[e("image",{staticClass:"pribgc",attrs:{src:"../../static/img/prizebgc.png",mode:"widthFix"}}),e("view",{staticClass:"priname"},[t._v("恭喜你！获得奖品：")]),e("view",{staticClass:"priname"},[t._v(t._s(t.prize_info?t.prize_info.prize_name:"未中奖"))]),e("image",{staticClass:"priimg",attrs:{src:t.prize_info?t.prize_info.prize_img:"../../static/img/autherfrid.png",mode:""}}),e("button",{staticClass:"lookdetilbtn",attrs:{"data-id":t.prize_info?t.prize_info.id:"",eventid:"7e595675-6"},on:{click:t.gogoodsfun}},[t._v("查看奖品")])],1)]):t._e(),t.auther?e("view",{staticClass:"mask",attrs:{catchtouchmove:"true",eventid:"7e595675-10"},on:{click:t.closeauther}},[0==t.fid?e("view",{staticClass:"autherbox"},[e("image",{staticClass:"autherbgc",attrs:{src:"../../static/img/auther.png"}}),e("button",{staticClass:"autherbtn",attrs:{"open-type":"getUserInfo",lang:"zh_CN","form-type":"submit",eventid:"7e595675-8"},on:{getuserinfo:t.onGotUserInfo}},[t._v("领取")])],1):t._e(),0!=t.fid?e("view",{staticClass:"fridautherbox"},[e("image",{staticClass:"autherbgc",attrs:{src:"../../static/img/autherfrid.png"}}),e("view",{staticClass:"fridinfo"},[e("image",{staticClass:"fridImg",attrs:{src:t.alldata?t.alldata.fUserInfo.headimg:""}}),e("view",{staticClass:"fridName"},[t._v(t._s(t.alldata?t.alldata.fUserInfo.nickname:""))])]),e("button",{staticClass:"autherbtn",attrs:{"open-type":"getUserInfo",lang:"zh_CN","form-type":"submit",eventid:"7e595675-9"},on:{getuserinfo:t.onGotUserInfo}},[t._v("帮Ta助力")])],1):t._e()]):t._e()])])},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})},"6fd4":function(t,a,e){"use strict";e.r(a);var i=e("ec39"),s=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);a["default"]=s.a},b798:function(t,a,e){},cf45:function(t,a,e){"use strict";e("71fa");var i=n(e("b0ce")),s=n(e("1d8c"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},e17a:function(t,a,e){"use strict";var i=e("b798"),s=e.n(i);s.a},ec39:function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e("c3c6")),s=r(e("560d")),n=r(e("c61f")),c=r(e("d7e9")),o=e("7fa7");function r(t){return t&&t.__esModule?t:{default:t}}var l=null,u=[],d=[],v={data:function(){return{fid:0,qid:0,pristatu:!1,auther:!1,alldata:null,globalData:null,ruleList:[],round_count:null,inviteList:[],available_num:3,winnerList:[],canvas_isdraw:!1,canvas_width:315,canvas_height:138,canvas_clearw:20,canvas_clearh:20,canvas_percent:.3,canvas_forPercent:!1,result_val:"未中奖",prize_info:"",activity_endtime:!1,htmlshow:!0,reping:!0}},onShow:function(){this.load(),this.reset()},onLoad:function(a){if(t.setNavigationBarTitle({title:n.default.getres?n.default.getres.box_name:c.default.vname}),a.scene){var e=decodeURIComponent(a.scene);if(-1!=e.indexOf("&")){for(var i=new Object,s=e.split("&"),o=0;o<s.length;o++)i[s[o].split("=")[0]]=decodeURI(s[o].split("=")[1]);a.qid=i.qid,a.fid=i.fid}else a.qid=e.split("=")[1]}this.fid=a.fid?a.fid:0,this.qid=a.qid?a.qid:0,l=t.createCanvasContext("guaguaCanvas"),this.initCanvas(),this.resetbox()},computed:{},methods:{resetbox:function(){u=[],d=[],this.canvas_forPercent=!1;for(var t=0;t<this.canvas_width;t++){u[t]=[];for(var a=0;a<this.canvas_height;a++)u[t][a]=0}},computerPercent:function(){for(var t=this,a=0;a<d.length;a++)for(var e=d[a].ax;e<=d[a].bx;e++)for(var i=d[a].ay;i<=d[a].by;i++)e>=0&&e<t.canvas_width&&i>=0&&i<t.canvas_height&&(u[e][i]=1);var s=0;for(a=0;a<u.length;a++)for(e=0;e<u[a].length;e++)1==u[a][e]&&(s+=1);if(s/(this.canvas_width*this.canvas_height)>this.canvas_percent){if(this.pristatu=!0,this.canvas_isdraw=!1,this.reset(),t.canvas_forPercent)return!1}else console.log("no")},initCanvas:function(){var t=s.default.getWindowSize().scale;l.drawImage("../../static/img/cardmask.png",0,0,this.canvas_width*t*2,this.canvas_height*t*2),l.draw()},startCanvas:function(a){var e=this;this.available_num<=0?(this.canvas_isdraw=!1,t.showModal({showCancel:!1,title:"提示",content:"您没有抽奖机会!",success:function(t){t.confirm?console.log("用户点击确定"):t.cancel&&console.log("用户点击取消")}})):!this.canvas_isdraw&&this.reping&&(this.reping=!1,(0,o.getUserOpenId)().then(function(t){i.default.requst("index/luckdraw","POST",{sessionKey:t}).then(function(t){e.result_val=t.data.prize_info.prize_name,e.canvas_isdraw=!0,e.prize_info=t.data.prize_info,e.reping=!0}).catch(function(t){e.reping=!0,wx.showModal({showCancel:!1,title:"提示",content:t,success:function(t){t.confirm?console.log("用户点击确定"):t.cancel&&console.log("用户点击取消")}})})}))},moveCanvas:function(t){if(console.log(t),this.canvas_isdraw){var a=t.x,e=t.y;l.clearRect(a-this.canvas_clearw/2,e-this.canvas_clearh/2,this.canvas_clearw,this.canvas_clearh),d.push({ax:Math.round(a-this.canvas_clearw/2),ay:Math.round(e-this.canvas_clearh/2),bx:Math.round(a+this.canvas_clearw/2),by:Math.round(e+this.canvas_clearh/2)}),l.draw(!0)}},endCanvas:function(t){this.canvas_isdraw&&this.computerPercent()},reset:function(){this.canvas_isdraw=!1,this.initCanvas(),this.resetbox()},gomygoods:function(){t.navigateTo({url:"/pages/goods/goods",success:function(t){},fail:function(){},complete:function(){}})},load:function(){var t=this;(0,o.getUserOpenId)(this.fid,this.qid).then(function(a){i.default.requst("index/index","POST",{sessionKey:a,fid:t.fid}).then(function(a){setTimeout(function(){t.htmlshow=!1},500),t.activity_endtime=new Date(n.default.getres.activity_endtime.replace(/-/g,"/")).getTime()>(new Date).getTime(),t.alldata=a.data,t.ruleList=a.data.ruleList,t.Jack_pots_val=a.data.activityPrize,t.globalData=n.default,t.available_num=a.data.userInfo.draw_num,t.round_count=a.data.userInfo.round_count,t.inviteList=a.data.inviteList,t.winnerList=a.data.winnerList,1==n.default.getres.authorize_status&&(t.auther=!0)})})},goranking:function(){t.navigateTo({url:"/pages/rank/rank",success:function(t){},fail:function(){},complete:function(){}})},lookallfun:function(){var a=4;t.navigateTo({url:"/pages/Inviterall/Inviterall?id="+a,success:function(t){},fail:function(){},complete:function(){}})},gogoodsfun:function(a){var e=a.currentTarget.dataset.id;t.navigateTo({url:"/pages/goodsdetil/goodsdetil?prize_id="+e,success:function(t){},fail:function(){},complete:function(){}})},closeprize:function(){this.pristatu=!1,this.load()},onGotUserInfo:function(t){var a=this;"getUserInfo:ok"==t.detail.errMsg&&(this.auther=!1),(0,o.bindGetUserInfo)(t).then(function(t){a.load()})},goexchange:function(a){var e=a.currentTarget.dataset.appid;(0,o.getUserOpenId)().then(function(a){i.default.requst("user/exchange","POST",{sessionKey:a}).then(function(a){var i=a.data;console.log(i),t.navigateToMiniProgram({appId:e,path:"pages/start/start",envVersion:"trial",extraData:{key:i},success:function(t){console.log(1)}})}).catch(function(t){console.log(t)})})},openxcx:function(a){var e=a.currentTarget.dataset.appid;console.log(e,"00"),t.navigateToMiniProgram({appId:e,envVersion:"trial",success:function(t){(0,o.getUserOpenId)().then(function(t){i.default.requst("index/opendate","POST",{sessionKey:t}).then(function(t){console.log(3)})})}})}},onShareAppMessage:function(t){var a=this;return{title:a.alldata.activityInfo.share_title,path:"pages/index/index?fid="+n.default.getres.uid,imageUrl:a.alldata.activityInfo.share_img,success:function(t){var a={share_type:3,sessionKey:n.default.sessionKey};app.utils.requst("user/usershare","POST",a).then(function(t){console.log(t)})},fail:function(t){}}}};a.default=v}).call(this,e("543d")["default"])}},[["cf45","common/runtime","common/vendor"]]]);